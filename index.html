<!DOCTYPE html>
<html lang="en">

<head>
    <title>Belle id√©e</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
</head>
<link type="text/css" rel="stylesheet" href="main.css">

<body>
    <audio id="interview">
        <source src="interview.mp3" type="audio/mpeg">
    </audio>
    <script type="module">
        import * as THREE from 'https://bisiyo.github.io/belleidee/build/three.module.js';


			import { TrackballControls } from 'https://bisiyo.github.io/belleidee/jsm/TrackballControls.js';
			import { PCDLoader } from 'https://bisiyo.github.io/belleidee/jsm/PCDLoader.js';

			let container;
			let camera, controls, scene, renderer;
let Objpoints, listenn;

			const mouse = new THREE.Vector2();


			init();
			animate();
			function init() {

				scene = new THREE.Scene();
				scene.background = new THREE.Color( 0x000000 );

				camera = new THREE.PerspectiveCamera( 15, window.innerWidth / window.innerHeight, 0.01, 40 );
				camera.position.x = 0.4;
				camera.position.z = - 2;
				camera.up.set( 0, 0, 1 );

				scene.add( camera );

				renderer = new THREE.WebGLRenderer( { antialias: true } );
				renderer.setPixelRatio( window.devicePixelRatio );
				renderer.setSize( window.innerWidth, window.innerHeight );
				document.body.appendChild( renderer.domElement );

				const loader = new PCDLoader();
				loader.load( 'https://bisiyo.github.io/belleidee/models/dense_model.pcd', function ( points ) {

					scene.add( points );
					const center = points.geometry.boundingSphere.center;
					controls.target.set( center.x, center.y, center.z );
					controls.update();
points.material.size = 0.07;

						points.material.needsUpdate = true;
						points.position.z = 20;

												points.position.x = -2;

												points.position.y = -2;


											Objpoints = points;


				} );



				container = document.createElement( 'div' );
				document.body.appendChild( container );
				container.appendChild( renderer.domElement );

				controls = new TrackballControls( camera, renderer.domElement );

				controls.rotateSpeed = 2.0;
				controls.zoomSpeed = 0.3;
				controls.panSpeed = 0.2;

				controls.staticMoving = true;

				controls.minDistance = 0.3;
				controls.maxDistance = 0.3 * 100;


				window.addEventListener( 'resize', onWindowResize );

								document.addEventListener( 'click', onDocumentMouseMove );
								document.getElementById("interview").onpause = function() {
listenn = false;
};


			}

			function onWindowResize() {

				camera.aspect = window.innerWidth / window.innerHeight;
				camera.updateProjectionMatrix();
				renderer.setSize( window.innerWidth, window.innerHeight );
				controls.handleResize();

			}


			function onDocumentMouseMove( ) {


				if (listenn) {
					listenn = false;
					 document.getElementById("interview").pause();

				} else {
					listenn = true;
					document.getElementById("interview").play();

				}

}


			function animate() {

				requestAnimationFrame( animate );
				//controls.update();
				renderer.render( scene, camera );




				if (listenn) Objpoints.rotation.z += 0.001;

			}

		</script>
</body>

</html>