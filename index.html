<!DOCTYPE html>
<html lang="en">

<head>
    <title>Belle idée</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
</head>
<link type="text/css" rel="stylesheet" href="main.css">
<link rel="stylesheet" href="blurry-load.min.css">
<script src="blurry-load.min.js"></script>

<body style="overflow:hidden;">
    <div class="hours">21.05.21</div>
    <audio class="audi" id="audio0" preload="metadata" onended="">
        <source type="audio/mp3">
    </audio>
        <audio  class="audi" id="audio1" preload="metadata" onended="">
        <source type="audio/mp3">
    </audio>
        <audio  class="audi" id="audio2" preload="metadata" onended="">
        <source type="audio/mp3">
    </audio>
        <audio  class="audi" id="audio3" preload="metadata" onended="">
        <source type="audio/mp3">
    </audio>
        <audio  class="audi" id="audio4" preload="metadata" onended="">
        <source type="audio/mp3">
    </audio>
        <div class="dropdown outside" style="position: absolute;">
        <button class="dropbtn"><img style="width: 30px;" src="https://feministcurricula.org/careclub/img/menu.png"></button>
        <div class="dropdown-content">
            <a style="padding-top:unset; color: Blue; cursor:default">ECOUTE BELLE-IDEE </a>
            <a href="careclubabi.html">Le CARECLUB à Belle-Idée </a>
            <a href="apropos.html">A propos du projet</a>
            <a href="contact.html">Contact</a>
            <a href="catalogue.html">Catalogue de sons</a>
            <a href="references.html">Références </a>
        </div>
    </div>
    <img class="sound on outside"  onclick="soundAction()">
        <img class=" inside" id='back' src="https://feministcurricula.org/careclub/img/back.png" style="    padding: 2vh;
    width: 50px; cursor: pointer;"  onclick='goOutside()'>

    <div class="restart round outside" onclick="reset()" style="color: black; font-size: 24px ;">
          <img style="width: 60px" 
     src="https://feministcurricula.org/careclub/img/restart.png">
    </div>

  


        <div id="myModal" class="modal">

  <!-- Modal content -->
  <div class="modal-content">Attention !<br><br>
    <div>Vous vous apprêtez à vivre une expérience sonore qui traite de soin et de santé mentale.
Ainsi, certaines paroles sont susceptibles d’éveiller des souvenirs ou des expériences traumatisantes.
<br><br>
Pour plus de confort nous vous conseillons d'utiliser des écouteurs et de passer en mode plein écran, ainsi que d’activer le son de votre appareil.<br><br><button class="enterWeb">Continuer</button>
</div>

  </div>
</div>
  <div id='imgcontainer'></div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

   <script type="module">
        import * as THREE from 'https://bisiyo.github.io/belleidee/build/three.module.js';


      import { TrackballControls } from 'https://bisiyo.github.io/belleidee/jsm/TrackballControls.js';
      import { PCDLoader } from 'https://bisiyo.github.io/belleidee/jsm/PCDLoader.js';

        
      let container;
      let camera, controls, scene, renderer;
let Objpoints;
let listennX = false;
let listennY = false;
let listennZ = false;
let sens;

let loadIndexObj = 0;
let listObjects = ['abribus','air','appeleur','banc','barrage','guide','guideB','moto','oeuvre', 'bac'];


      const mouse = new THREE.Vector2();


      init();
      animate();
      function init() {

        scene = new THREE.Scene();
scene.background = null;
        camera = new THREE.PerspectiveCamera( 15, window.innerWidth / window.innerHeight, 0.01, 40 );
        camera.position.x = 0.4;
        camera.position.z = - 2;
        camera.up.set( 0, 0, 1 );
        camera.far = 200;
        camera.near = 0.001;

        scene.add( camera );

        renderer = new THREE.WebGLRenderer( { antialias: true, alpha: true } );
        renderer.setPixelRatio( window.devicePixelRatio );
        renderer.setSize( window.innerWidth, window.innerHeight );
        renderer.domElement.setAttribute('class', "radial-gradient");
        document.body.appendChild( renderer.domElement );

        loadNewObject();


        container = document.createElement( 'div' );
        document.body.appendChild( container );
        container.appendChild( renderer.domElement );

        controls = new TrackballControls( camera, renderer.domElement );

        controls.rotateSpeed = 2.0;
        controls.zoomSpeed = 0.3;
        controls.panSpeed = 0.2;

        controls.staticMoving = true;

        controls.minDistance = 0.3;


        window.addEventListener( 'resize', onWindowResize );

                document.addEventListener( 'click', onDocumentMouseMove );


      }



      function onWindowResize() {

        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize( window.innerWidth, window.innerHeight );
        controls.handleResize();

      }

      function loadNewObject() {        
        const loader = new PCDLoader();
        let urlLoader = "https://bisiyo.github.io/belleidee/models/" + listObjects[loadIndexObj] + ".pcd";
        loader.load( urlLoader, function ( points ) {

          scene.add( points );
          const center = points.geometry.boundingSphere.center;
          controls.target.set( center.x, center.y, center.z );
          controls.update();
points.material.size = 0.1;

            points.material.needsUpdate = true;
            points.position.z = 20;
            points.name = listObjects[loadIndexObj];
            points.visible = false;

                        points.position.x = -2;

                        points.position.y = -2;

                      Objpoints = points;
                      loadIndexObj++;
                      if (loadIndexObj < listObjects.length) {
loadNewObject();
                      } else {
let op = document.getElementsByClassName('open');
for (var i = 0; i < op.length; i++) {
    op[i].addEventListener("click", function(){objOpen(this.getAttribute('objet'), this.getAttribute('number'))});
}

                      }


        } );
      }


      function onDocumentMouseMove( ) {
/*

        if (listenn) {
          listenn = false;
           document.getElementById("interview").pause();

        } else {
          listenn = true;
          document.getElementById("interview").play();

        }

        */

}


      function animate() {

        requestAnimationFrame( animate );
        //controls.update();
        renderer.render( scene, camera );
        renderer.setClearAlpha(0);




        if (listennY) Objpoints.rotation.y += 0.001*sens;
        if (listennX) Objpoints.rotation.x += 0.001*sens;
        if (listennZ) Objpoints.rotation.z += 0.001*sens;

      }



      $( document ).ready(function() {

   document.getElementById('back').addEventListener("click", function(){
Objpoints.visible = false;

    });

document.getElementsByClassName('restart')[0].addEventListener("click", function(){

 


let op = document.getElementsByClassName('open');
for (var i = 0; i < op.length; i++) {
    op[i].addEventListener("click", function(){objOpen(this.getAttribute('objet'), this.getAttribute('number'))});
}});


});
      function objOpen(blo, bla) {

        insideobj = true;
       if (scene.getObjectByName(blo)) { scene.getObjectByName(blo).visible = true;
       Objpoints = scene.getObjectByName(blo);
       if (bla == '1') {
        listennY = true;
        listennX = true;
        listennZ = false;

       } else if (bla == '2') {
        listennY = true;
        listennX = false;
        listennZ = true;
       } else {
        listennY = false;
        listennX = true;
        listennZ = true;
       } 

       if ( Math.random() > 0.5) {
        sens = -1;
       } else {
        sens = 1;
       }
               objclick();


   }

      }

    </script>

</body>
<script type="text/javascript" src="map.js"></script>

<script type="text/javascript">
  $(document).mousemove(function(event) {
  windowWidth = $(window).width();
  windowHeight = $(window).height();
  
  mouseXpercentage = Math.round(event.pageX / windowWidth * 100);
  mouseYpercentage = Math.round(event.pageY / windowHeight * 100);
  
  $('.radial-gradient').css('background', 'radial-gradient(at ' + mouseXpercentage + '% ' + mouseYpercentage + '%, #bc2e41, #2c4e90)');

});
  $('.enterWeb').click(function(event) {
  document.getElementById("myModal").style.display = "none";
});

  function dateappear(blo) {
    document.getElementsByClassName("hours")[0].innerHTML = blo.getAttribute('date') + ' - ' + blo.getAttribute('hours');
    document.getElementsByClassName("hours")[0].style.display = "block";
  }

    function datedisappear() {
    document.getElementsByClassName("hours")[0].style.display = "none";
  }

  function objclick() {
var slides = document.getElementsByClassName("open");
for (var i = 0; i < slides.length; i++) {
    slides[i].style.display = "none";
}

var slides = document.getElementsByClassName("outside");
for (var i = 0; i < slides.length; i++) {
    slides[i].style.display = "none";
}


var ins = document.getElementsByClassName("inside");
for (var i = 0; i < ins.length; i++) {
    document.getElementsByClassName("inside")[i].style.display = "block";
}

    document.getElementsByClassName("hours")[0].style.display = "block";


  }

    function goOutside(){
                   let allaudio = document.getElementsByClassName('audi');

               for (var i = 0; i < allaudio.length; i++) {
                    allaudio[i].pause();
                    disableControls(allaudio[i]);
                }
var slides = document.getElementsByClassName("open");
for (var i = 0; i < slides.length; i++) {
    slides[i].style.display = "block";
}

var slides = document.getElementsByClassName("outside");
for (var i = 0; i < slides.length; i++) {
    slides[i].style.display = "block";
}


var ins = document.getElementsByClassName("inside");
for (var i = 0; i < ins.length; i++) {
    document.getElementsByClassName("inside")[i].style.display = "none";
}

    document.getElementsByClassName("hours")[0].style.display = "none";
    insideobj = false;               

}

function disableControls(x) { 
    x.controls = false;
    x.load();
} 





</script>

</html>